/* chartist-plugin-threshold 0.0.2
 * Copyright Â© 2016 Gion Kunz
 * Free to use under the WTFPL license.
 * http://www.wtfpl.net/
 */

!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a["Chartist.plugins.ctThreshold"]=b()}(this,function(){return function(a,b,c){"use strict";function d(a,b,c){var d=a.svg.querySelector("defs")||a.svg.elem("defs"),e=a.svg.width(),f=a.svg.height(),g=d.elem("mask",{x:0,y:0,width:e,height:f,id:c.maskNames.aboveThreshold}),h=d.elem("mask",{x:0,y:0,width:e,height:f,id:c.maskNames.belowThreshold});if(b.hasData()){var i=b.generateSvgPath(a,c.lineSmooth),j=i.pathElements[0],k=i.pathElements[i.pathElements.length-1],l=i.clone(!0).position(0).remove(1).move(j.x,0).line(j.x,j.y).position(i.pathElements.length+1).line(k.x,0),m=i.position(0).remove(1).move(j.x,f).line(j.x,j.y).position(i.pathElements.length+1).line(k.x,f);g.elem("path",{d:l.stringify(),fill:"white"}),h.elem("path",{d:m.stringify(),fill:"white"})}return d}function e(a,b){this.chart=a,this.value=b,this.normalize(b)}var f={threshold:0,classNames:{aboveThreshold:"ct-threshold-above",belowThreshold:"ct-threshold-below"},maskNames:{aboveThreshold:"ct-threshold-mask-above",belowThreshold:"ct-threshold-mask-below"},lineSmooth:c.Interpolation.none({fillHoles:!0})};c.plugins=c.plugins||{},c.plugins.ctThreshold=function(a){return a=c.extend({},f,a),function(b){if(b instanceof c.Line||b instanceof c.Bar){var f=new e(b,a.threshold);b.on("draw",function(b){if(!b.series||!b.series.name||b.series.name!==f.value)if("point"===b.type){var c=f.getThresholdValue(b);b.element.addClass(b.value.y>=c?a.classNames.aboveThreshold:a.classNames.belowThreshold)}else"line"!==b.type&&"bar"!==b.type&&"area"!==b.type||(b.element.parent().elem(b.element._node.cloneNode(!0)).attr({mask:"url(#"+a.maskNames.aboveThreshold+")"}).addClass(a.classNames.aboveThreshold),b.element.attr({mask:"url(#"+a.maskNames.belowThreshold+")"}).addClass(a.classNames.belowThreshold))}),b.on("created",function(b){f.hasData()&&d(b,f,a)})}}},e.prototype.getThresholdValue=function(a){var b;return void 0!==a.value.x?b=this.series.data.filter(function(b){return b.x===a.value.x}).pop():this.series.data[a.index]&&(b=this.series.data[a.index]),c.getMultiValue(b,"y")},e.prototype.hasData=function(){return this.series&&this.series.data.length>0},e.prototype.generateSvgPath=function(a,b){var c=[],d=[],e=this.series.data;return e.forEach(function(b,f){var g={x:a.chartRect.x1+a.axisX.projectValue(b,f,e),y:a.chartRect.y1-a.axisY.projectValue(b,f,e)};c.push(g.x,g.y),d.push({value:b,valueIndex:f})}),b(c,d)},e.prototype.normalize=function(a){if(this.series=null,c.isNum(a)){var b=[];if(this.chart.data.series.length){var d=this.chart.options.axisX;if(d.type&&"StepAxis"!=d.type.prototype.constructor.name){var e={};this.chart.data.series.forEach(function(a){(a.data||a).forEach(function(a){e[a.x]=!0})}),b=Object.keys(e).map(function(b){return{x:+b,y:a}})}else{var f=this.chart.data.series.reduce(function(a,b){return Math.max(a,(b.data||b).length)},0);b=c.times(f).map(function(){return a})}}this.series={data:b,name:"_threshold"}}else if("string"==typeof a?this.series=this.chart.data.series.reduce(function(b,c){return c.name===a?c:b},a):a.constructor===Array&&(this.series={data:a,name:"_threshold"}),!(this.series instanceof Object&&this.series.data))throw new Error("Invalid 'threshold' value provided to chartist-plugin-threshold: "+a);var g=c.normalizeData({series:[this.series]});return this.series.data=c.getDataArray(g,this.chart.options.reverseData,!0).shift(),this}}(window,document,Chartist),Chartist.plugins.ctThreshold});
//# sourceMappingURL=chartist-plugin-threshold.min.js.map